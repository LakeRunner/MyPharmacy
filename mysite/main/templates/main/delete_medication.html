{% extends 'main/layout.html' %}
{% block content %}
    <p></p>
    <a href="{% url 'home' %}" class="home-button">Вернуться на главную</a>
    <div class="content-container">
        <p></p>
        <h2> Вы уверены, что хотите удалить запись о лекарстве "{{medication.medication_name}}"?</h2>

        <div class="flex-container">
            <form method="post" action="{% url 'delete_medication' pk=medication.pk %}">
                {% csrf_token %}
                <button type="submit" class="accept-button">Подтвердить</button>
                <a href="{% url 'medications' %}" class="accept-button">Отмена</a>
            </form>
        </div>
    </div>

    <script>
        function confirmDelete() {
            if (confirm('Вы точно хотите удалить запись об этом лекарстве?')) {
                var xhr = new XMLHttpRequest();
                xhr.open('POST', '{% url "delete_medication" pk=medication.pk %}', true);
                xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
                xhr.onload = function() {
                    if (xhr.status >= 200 && xhr.status < 400) {
                        var response = JSON.parse(xhr.responseText);
                        alert(response.message);
                        window.location.href = '{% url "medications" %}';
                    } else {
                        alert('Произошла ошибка при удалении лекарства.');
                    }
                };
                xhr.onerror = function() {
                    alert('Произошла ошибка при удалении лекарства.');
                };
                xhr.send();
            }
        }
    </script>
{% endblock %}